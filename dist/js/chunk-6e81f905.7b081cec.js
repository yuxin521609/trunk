(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e81f905"],{"0c55":function(t,e,i){"use strict";i.r(e);var a,n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.printsDialogVisible?i("el-dialog",{staticClass:"alarmPopup",attrs:{title:"打印吊牌",visible:t.printsDialogVisible,width:"1000px","append-to-body":""},on:{"update:visible":function(e){t.printsDialogVisible=e}}},[i("div",{staticClass:"dialog-search"},[i("el-form",{ref:"filtersForm",staticClass:"item-form",attrs:{model:t.filtersData,"label-width":"100px",size:"small",inline:""}},[i("el-form-item",{attrs:{prop:"printsOptions",label:"选择打印机："}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.printsValue,callback:function(e){t.printsValue=e},expression:"printsValue"}},t._l(t.printsOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),i("el-form-item",{attrs:{prop:"setNum",label:"批量设置："}},[i("el-input",{staticClass:"input-w",attrs:{placeholder:"请输入数量"},model:{value:t.filtersData.setNum,callback:function(e){t.$set(t.filtersData,"setNum",t._n(e))},expression:"filtersData.setNum"}})],1)],1)],1),i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.tableListData,stripe:"","empty-text":"暂无数据","header-align":"center","header-row-class-name":"item-table-header","highlight-current-row":!0,height:"400"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50"}}),i("el-table-column",{attrs:{prop:"code",align:"center",label:"商品编码","min-width":"100"}}),i("el-table-column",{attrs:{prop:"productCode",align:"center",label:"商品款号","min-width":"100"}}),i("el-table-column",{attrs:{prop:"name",align:"center",label:"商品名称","min-width":"100"}}),i("el-table-column",{attrs:{prop:"image",align:"center",label:"商品图片","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{staticClass:"table-img-wh",attrs:{src:t.row.image}})]}}],null,!1,2668365997)}),i("el-table-column",{attrs:{prop:"fullCateName",align:"center",label:"商品分类","min-width":"100"}}),i("el-table-column",{attrs:{prop:"tagBrandName",align:"center",label:"品牌","min-width":"100"}}),i("el-table-column",{attrs:{prop:"size",align:"center",label:"尺码","min-width":"100"}}),i("el-table-column",{attrs:{prop:"color",align:"center",label:"颜色","min-width":"100"}}),i("el-table-column",{attrs:{prop:"printNum",align:"center",label:"打印数量","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input-number",{attrs:{size:"mini",min:1,max:100},model:{value:e.row.printNum,callback:function(i){t.$set(e.row,"printNum",i)},expression:"scope.row.printNum"}})]}}],null,!1,168327378)})],1)],1),i("div",{staticClass:"item-right mt-10"},[i("el-button",{attrs:{size:"small"},on:{click:t.closeDialog}},[t._v("取消打印")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitPrint()}}},[t._v("确认打印")])],1)]):t._e(),i("prints-status-dialog",{ref:"printsStatusRef",on:{setParentPrintsStatus:t.getPrintsStatus}})],1)},l=[],s=(i("c5f6"),i("fca0"),i("322a")),r=i("9539"),o=i("4faf"),u=[],c={name:"tp-prints-dialog",components:{PrintsStatusDialog:o["a"]},data:function(){return{filtersData:{setNum:null},tableListData:[],printsOptions:[],printsDialogVisible:!1,printsValue:null,selectPrintData:[],tableLoading:!1}},created:function(){this.init()},mounted:function(){},methods:{init:function(){this.filtersData={setNum:null},this.tableListData=[],this.selectPrintData=[],u=[]},getLodopData:function(){try{a=Object(s["a"])();for(var t=[],e=a.GET_PRINTER_COUNT(),i=0;i<e;i++)t.push({label:a.GET_PRINTER_NAME(i),value:i});this.printsOptions=t}catch(n){}},popupInit:function(t){this.getTableList(t),this.printsDialogVisible=!0,this.getLodopData()},getTableList:function(t){var e=this;this.tableLoading=!0,this.request(this.api.product.productGoods_list,{productCodes:t},!0).then(function(t){e.tableLoading=!1;for(var i=t.data,a=0;a<i.length;a++)i[a].printNum=1;e.tableListData=i}).catch(function(t){e.tableLoading=!1})},handleSelectionChange:function(t){this.selectPrintData=t},submitPrint:function(){var t=this;if(null!=this.printsValue)if(this.selectPrintData.length>0){for(var e=[],i=0;i<this.selectPrintData.length;i++)e.push({count:this.selectPrintData[i].printNum,productGoodsCode:this.selectPrintData[i].code});this.tableLoading=!0,this.request(this.api.product.productGoodsSn_createSns,e).then(function(e){t.handlePrint(e),t.tableLoading=!1}).catch(function(e){t.tableLoading=!1})}else this.$message.error("请选择打印数据！");else this.$message.error("请选择打印机！")},handlePrint:function(t){var e=this;if(t.length>0){u=[];for(var i=0;i<t.length;i++)for(var n=t[i].productGoodsSns||[],l=0;l<n.length;l++){var o=JSON.parse(JSON.stringify(t[i])),c=new Object;c=o,c.productGoodsSn=n[l],u.push(c),o=null,c=null}if(u){a=Object(s["a"])();for(var p=0;p<u.length;p++)Object(r["a"])(a,u[p],this.printsValue);if(a.CVERSION)return void(CLODOP.On_Return=function(t,i){i?e.$refs.printsStatusRef.propInit():alert("放弃打印！")})}}},getPrintsStatus:function(){for(var t=this,e=[],i=0;i<u.length;i++)e.push({sn:u[i].productGoodsSn});this.request(this.api.product.productGoodsSn_confirmed,e).then(function(e){t.$message.success("更新打印数据成功"),t.$refs.printsStatusRef.closeDialog()}).catch(function(e){t.$message.error("更新打印数据失败"),t.$refs.printsStatusRef.closeDialog()})},closeDialog:function(){this.printsDialogVisible=!1},handleAllNum:function(){}},watch:{"filtersData.setNum":function(t){if(Number.isFinite(t))for(var e=0;e<this.tableListData.length;e++)this.tableListData[e].printNum=t;else this.filtersData.setNum=null}}},p=c,d=(i("5e3c"),i("2877")),h=Object(d["a"])(p,n,l,!1,null,"10dae076",null);e["default"]=h.exports},"5e3c":function(t,e,i){"use strict";var a=i("adaf"),n=i.n(a);n.a},adaf:function(t,e,i){},fca0:function(t,e,i){var a=i("5ca1"),n=i("7726").isFinite;a(a.S,"Number",{isFinite:function(t){return"number"==typeof t&&n(t)}})}}]);