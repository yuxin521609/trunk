(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d30e7"],{"5aaf":function(t,e,a){"use strict";a.r(e);var d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"router-config"},[a("div",{staticClass:"item-cont"},[a("div",{staticClass:"item-cont"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.addItem("app")}}},[t._v("新增APP")])],1),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.tableList,"row-key":"id",size:"mini",border:"",lazy:"",load:t.tableLoad,"tree-props":{children:"sublist",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"code",label:"编码",width:"120"}}),a("el-table-column",{attrs:{prop:"routePath",label:"路由地址","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"modulePath",label:"模块地址","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"meta",label:"元信息","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"按钮权限"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.authlist&&e.row.authlist.length?t._l(e.row.authlist,function(e){return a("el-button",{key:e.id,attrs:{type:"text",size:"small"},on:{click:function(a){return t.editItem("auth",e)}}},[t._v(t._s(e.name))])}):void 0}}],null,!0)}),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.code?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.editItem("menu",e.row)}}},[t._v("编辑")]):a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.editItem("app",e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.addItem("menu",e.row)}}},[t._v("新增子菜单")]),e.row.sublist&&0!==e.row.sublist.length||!e.row.code?t._e():a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.addItem("auth",e.row)}}},[t._v("新增按钮")])]}}])})],1)],1),a("el-dialog",{attrs:{title:t.isAddItem?"新增":"编辑",visible:t.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.addAndEditFormData,"label-width":"80px"}},["app"!=t.addAntEditType?a("el-form-item",{attrs:{label:"编码"}},[a("el-input",{model:{value:t.addAndEditFormData.code,callback:function(e){t.$set(t.addAndEditFormData,"code",e)},expression:"addAndEditFormData.code"}})],1):t._e(),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:t.addAndEditFormData.name,callback:function(e){t.$set(t.addAndEditFormData,"name",e)},expression:"addAndEditFormData.name"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-input",{model:{value:t.addAndEditFormData.type,callback:function(e){t.$set(t.addAndEditFormData,"type",e)},expression:"addAndEditFormData.type"}})],1),a("el-form-item",{attrs:{label:"路由地址"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addAndEditFormData.routePath,callback:function(e){t.$set(t.addAndEditFormData,"routePath",e)},expression:"addAndEditFormData.routePath"}})],1),a("el-form-item",{attrs:{label:"模块地址"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addAndEditFormData.modulePath,callback:function(e){t.$set(t.addAndEditFormData,"modulePath",e)},expression:"addAndEditFormData.modulePath"}})],1),a("el-form-item",{attrs:{label:"元信息"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addAndEditFormData.meta,callback:function(e){t.$set(t.addAndEditFormData,"meta",e)},expression:"addAndEditFormData.meta"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.dialogVisibleSub}},[t._v("确定")]),a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1)],1)],1)],1)},i=[],o=(a("7f7f"),a("28a5"),a("c5f6"),a("96cf"),a("3b8d"));a("ac6a");function n(t){return t<10?"0"+t:t}var s={name:"router_config",components:{},data:function(){return{tableList:[],isAddItem:!0,dialogVisible:!1,checkedRowData:{},addAndEditFormData:{},addAntEditType:""}},mounted:function(){var t=this;this.$nextTick(function(){t.getAppData()})},methods:{getAppData:function(){var t=this;this.request(this.api.system.application_List,{}).then(function(e){e.data&&e.data.length?(e.data.forEach(function(t){t.hasChildren=!0}),t.tableList=e.data):t.tableList=[]})},tableLoad:function(t,e,a){var d=this;if(t.code)a(t.sublist);else{var i=t.id;this.request(this.api.system.menu_getListMap,{appId:i}).then(function(t){t&&t.length?(d.tableDataInit(t),a(t)):a([])})}},tableDataInit:function(t){var e=this;t&&t.length&&t.forEach(function(t){t.sublist&&t.sublist.length?(t.hasChildren=!0,e.tableDataInit(t.sublist)):(t.sublist=[],t.hasChildren=!1)})},addItem:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e,a){var d,i,o,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a&&(this.checkedRowData=a),this.isAddItem=!0,this.dialogVisible=!0,this.addAntEditType=e,t.t0=e,t.next="app"===t.t0?7:"menu"===t.t0?9:"auth"===t.t0?15:20;break;case 7:return this.addAndEditFormData={name:"",routePath:"",modulePath:"",meta:""},t.abrupt("break",20);case 9:return t.next=11,this.request(this.api.user.get_userinfo,{},!0);case 11:return d=t.sent,this.addAndEditFormData={name:"",code:"",routePath:"",modulePath:"",meta:"",type:0,appId:a.appId||a.id,parentId:"",parentCode:"",tenantId:d.tenantId},a.code?(this.addAndEditFormData.parentId=a.id,this.addAndEditFormData.parentCode=a.code,a.sublist&&0===a.sublist.length&&(this.addAndEditFormData.code=a.code+".01"),a.sublist&&a.sublist.length>0&&(i="0",a.sublist.forEach(function(t){var e=t.code.split("."),a=i.split("."),d=Number(e[e.length-1]),o=Number(a[a.length-1]);d>=o&&(e[e.length-1]=n(d+1),i=e.join("."))}),this.addAndEditFormData.code=i)):this.request(this.api.system.menu_getMaxMenuCode,{}).then(function(t){s.addAndEditFormData.code=Number(t)+1}),t.abrupt("break",20);case 15:return this.addAndEditFormData={menuId:a.id,code:"",name:"",routePath:"",modulePath:"",meta:""},a.authlist||this.$set(a,"authlist",[]),a.authlist&&0===a.authlist.length&&(this.addAndEditFormData.code="01"),a.authlist&&a.authlist.length>0&&(o="0",a.authlist.forEach(function(t){var e=Number(t.code);e>=Number(o)&&(o=n(e+1))}),this.addAndEditFormData.code=o),t.abrupt("break",20);case 20:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}(),editItem:function(t,e){this.checkedRowData=e,this.isAddItem=!1,this.dialogVisible=!0,this.addAntEditType=t,this.addAndEditFormData=JSON.parse(JSON.stringify(e))},dialogVisibleSub:function(){var t=this,e="";switch(this.addAntEditType){case"app":e=this.api.system.application_save;break;case"menu":e=this.api.system.menu_save;break;case"auth":e=this.api.system.auth_save;break}this.request(e,this.addAndEditFormData).then(function(e){switch(t.$notify.success({title:"成功",message:"操作成功"}),t.addAntEditType){case"app":t.getAppData();break;case"menu":if(t.addAndEditFormData.id)t.checkedRowData.name=e.name,t.checkedRowData.code=e.code,t.checkedRowData.routePath=e.routePath,t.checkedRowData.modulePath=e.modulePath,t.checkedRowData.meta=e.meta,t.checkedRowData.type=e.type;else{var a=t.checkedRowData.id;e.sublist=[],e.hasChildren=!1,t.$refs.table.store.states.lazyTreeNodeMap[a]?t.$refs.table.store.states.lazyTreeNodeMap[a].push(e):(t.checkedRowData.hasChildren=!0,t.checkedRowData.sublist&&t.checkedRowData.sublist.push(e))}break;case"auth":t.addAndEditFormData.id?(t.checkedRowData.name=e.name,t.checkedRowData.code=e.code,t.checkedRowData.routePath=e.routePath,t.checkedRowData.modulePath=e.modulePath,t.checkedRowData.meta=e.meta):t.checkedRowData.authlist.push(e);break}t.dialogVisible=!1})}},computed:{},watch:{}},l=s,r=a("2877"),c=Object(r["a"])(l,d,i,!1,null,"964ccede",null);e["default"]=c.exports}}]);